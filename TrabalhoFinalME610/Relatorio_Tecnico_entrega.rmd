---
title: ""
geometry: textwidth=18cm,textheight=24cm
lang: pt-br
header-includes:
- \usepackage{setspace}
- \usepackage{indentfirst}
- \usepackage[utf8]{inputenc}
- \usepackage{mathptmx}
- \usepackage{enumerate}
- \usepackage{url} 
- \usepackage{lipsum}
- \usepackage{multicol}
- \usepackage{float}
- \usepackage{subcaption}
output:
  pdf_document:
  html_document: default
  fig_caption: yes
  mainfont: Times New Roman
fontsize: 10bp
---

\begin{titlepage}
\begin{center}
\thispagestyle{empty}
\begin{figure}[!htb]
\begin{center}
\begin{minipage}[b]{0.5\linewidth}
\begin{center}
\end{center}
\end{minipage}
\begin{minipage}[b]{0.7\linewidth}
\begin{center}
\vspace*{1cm}
 {\large \bf Universidade Estadual de Campinas\\[5pt]
Instituto de Matemática, Estatística e Computação Cientifica\\[3pt]
Departamento de Estatística}
\end{center}
\end{minipage}
\end{center}
\end{figure}
\vspace*{\stretch{1}}
\begin{center}
\vspace*{5cm}
{\huge \bf Dor nas costas durante a gravidez \\[7pt]
Relatório Técnico\\[5pt]
}
\end{center}
\vspace*{\stretch{1}}
\begin{center}
\vspace*{4cm}
{\Large \bf Guilherme Pazian  RA:160323\break
}\\[3pt]
{\large \bf Professor: Mauricio Zevallos \\[5pt]
ME610}\\[5pt]
\end{center}
\vspace*{\stretch{1}}
\centerline{\bf Campinas-SP, 30 de Junho de 2017}
\vspace*{\stretch{1}}
\end{center}
\end{titlepage}

\doublespacing
\newpage

```{r global options, echo=FALSE}
#definindo opções padrões dos chunks
#fig.width = 4.5
#fig.asp=1.618/2
knitr::opts_chunk$set(fig.align='center',fig.path='Figs/', fig.pos="H", echo=FALSE, warning=FALSE, message=FALSE)
#mudando o separador decimal para resultados "printados"
options(OutDec= ",")
```

```{r pacotes e funcoes,echo=FALSE}
#carregando funções
source("funcoes.R")

#pacotes
library(ggplot2)
library(gridExtra) #multiplos gráficos ggplot2
library(grid) #multiplos gráficos ggplot2
library(plyr) #utilizar apply
library(dplyr) ##utilizar apply
library(reshape2) #utilizar a função melt
```

```{r reading the data,cache=TRUE}
dados_base <- read.table(file = "dados-trab.txt")
rotulos <- c("ID","Intensidade Dor","Mês da gravidez onde a dor começou","Idade da paciente","Altura da paciente (m)","Peso da paciente no início da gravidez (kg)","Peso no final da gravidez","Peso do bebê (kg)","Número de filhos anteriores à atual gravidez","A paciente teve dor nas costas em gravidezes anteriores?","Comprimidos e aspirina alivia a dor?","Bolsa de agua quente alivia a dor?","Banho quente alivia a dor?","Almofada atrás da cadeira alivia a dor?","Ficar em pé alivia a dor?","Estar sentada alivia a dor?","Estar deitada alivia a dor?","Caminhar alivia a dor?","Fadiga agrava a dor?","Inclinar-se agrava a dor?","Erguer-se agrava a dor?","Arrumar camas agrava a dor?","Lavar agrava a dor?","Passar roupa agrava a dor?","Uma ação intestinal agrava a dor?","Relações sexuais agrava a dor?","Tosser agrava a dor?","Espirrar agrava a dor?","Virar-se na cama agrava a dor?","Ficar em pé agrava a dor?","Estar sentada agrava a dor?","Estar deitada agrava a dor?","Caminhar agrava a dor?")
colnames(dados_base) <- rotulos

```


#1.Introdução


#2.Validação do banco de dados

Após uma analise prévia do banco de dados, observou-se uma inconsistência na base de dados, já que foi observada uma valor "0" para a variável relacionada à dor nas costas em gravidezes anteriores e este valor não têm nenhuma definição na descrição desta variável, portanto as observações com esta característica foram retiradas do banco de dados.


```{r insconsistencias}
library(dplyr)
#tirando inconsistências
dados_base <- filter(dados_base, `A paciente teve dor nas costas em gravidezes anteriores?` != 0)
```

```{r inteiro em fator}
#fator

dados <- dados_base
dados$`Intensidade Dor`<- ordered(dados$`Intensidade Dor`, levels = c(0,1,2,3),labels = c("Nada","Nada que chegue a incomodar",
"Problemática, mas não forte", "Forte"))

dados$`Mês da gravidez onde a dor começou` <- ordered(dados$`Mês da gravidez onde a dor começou`)

dados$`Número de filhos anteriores à atual gravidez` <- ordered(dados$`Número de filhos anteriores à atual gravidez`)

dados$`A paciente teve dor nas costas em gravidezes anteriores?` <- ordered(dados$`A paciente teve dor nas costas em gravidezes anteriores?`,levels = c(1,2,3,4), labels = c("Não aplicável","Não","Sim, suave","Sim, forte"))

dados[,11:33] <- apply(dados[,11:33],2,function(x){factor(x,levels = c(0,1),labels = c("Não","Sim"))})

```

#3.Análise Descritiva

##3.1.Boxplots

```{r box_idade, fig.cap = legenda_box_idade,fig.width = 4.5,fig.asp=1.618/2.5}
box_idade <- ggplot(data = dados,mapping = aes(x = `Intensidade Dor`, y=  `Idade da paciente`)) + geom_boxplot()  + theme_light() + theme(axis.text.x = element_text(angle = 15,hjust = 1,size = 10))
box_idade
legenda_box_idade = "Boxplot para idade da paciente por grupo de intensidade de dor nas costas durante a gravidez. Note que os grupos 'Nada que chegue a incomodar' e 'Problemática, mas não forte' parecem ser os grupos mais similares, o grupo 'Nada' e 'Forte' parecem ser distintos tanto entre si quanto entre os demais grupos quanto à idade da paciente."
```

```{r box_altura, fig.cap = legenda_box_altura,fig.width = 4.5,fig.asp=1.618/2.5}
box_altura <- ggplot(data = dados,mapping = aes(x = `Intensidade Dor`, y=  `Altura da paciente (m)`)) + geom_boxplot() + theme_light() + theme(axis.text.x = element_text(angle = 15,hjust = 1,size = 10))
box_altura
legenda_box_altura = "Boxplot para altura da paciente por grupo de intensidade de dor nas costas durante a gravidez. Note que os grupos 'Nada que chegue a incomodar' e 'Problemática, mas não forte' parecem ser os grupos mais similares, o grupo 'Nada' e 'Forte' parecem ser distintos tanto entre si quanto entre os demais grupos quanto à altura da paciente."
```

```{r fig.cap = legenda_box_PesoAntes,fig.width = 4.5,fig.asp=1.618/2.5}
box_PesoAntes <- ggplot(data = dados,mapping = aes(x = `Intensidade Dor`, y=  `Peso da paciente no início da gravidez (kg)`)) + geom_boxplot() + theme_light() + theme(axis.text.x = element_text(angle = 15,hjust = 1)) + ylab("Peso início da gravidez (kg)")
box_PesoAntes
legenda_box_PesoAntes <- "Boxplot para Peso da paciente antes da gravidez por grupo de intensidade de dor nas costas durante a gravidez. Note que os grupos 'Nada que chegue a incomodar' e 'Problemática, mas não forte' parecem ser os grupos mais similares, o grupo 'Nada' e 'Forte' parecem ser distintos tanto entre si quanto entre os demais grupos quanto ao peso antes da gravidez da paciente."
```

```{r fig.cap = legenda_box_PesoDepois,fig.width = 4.5,fig.asp=1.618/2.5}
box_PesoDepois <- ggplot(data = dados,mapping = aes(x = `Intensidade Dor`, y=  `Peso no final da gravidez`)) + geom_boxplot() + theme_light() + theme(axis.text.x = element_text(angle = 15,hjust = 1)) + ylab("Peso fim da gravidez (kg)")
box_PesoDepois
legenda_box_PesoDepois <- "Boxplot para Peso da paciente depois da gravidez por grupo de intensidade de dor nas costas durante a gravidez. Note que parece existir uma associação entre o peso da paciente após a gravidez com a intensidade de dor nas costas da paciente, pois se observa quantis sempre maiores para os boxplots à direita, ou seja, conforme se muda para grupos de intensidade de dor maior se observa os três primeiros quartis das distribuições do peso da paciente antes da gravidez com valor maior em comparação com a distribuição de peso da paciente depois da gravidez em grupos intensidade de dores menores, de maneira que o peso no final da gravidez da paciente parece um fator associado à intensidade de dor."
```

```{r fig.cap = legenda_box_PesoBebe,fig.width = 5,fig.asp=1.618/3}
box_PesoBebe <- ggplot(data = dados,mapping = aes(x = `Intensidade Dor`, y=  `Peso do bebê (kg)`)) + geom_boxplot() + theme_light() + theme(axis.text.x = element_text(angle = 15,hjust = 1))
box_PesoBebe
legenda_box_PesoBebe <- "Boxplot para Peso do Bebe por grupo de intensidade de dor nas costas durante a gravidez. Note que parece existir uma associação entre o peso do Bebe com a intensidade de dor nas costas da paciente, pois se observa quantis sempre maiores para os boxplots à direita, ou seja, conforme se muda para grupos de intensidade de dor maior se observa os três primeiros quartis das distribuições do peso do Bebe com valor maior em comparação com a distribuição de peso do Bebe em grupos intensidade de dores menores, de maneira que o peso Bebe parece um fator associado à intensidade de dor."
```

##3.2.Gráficos de Barra
```{r Preparacao dos dados para bar_plot}
dados_Nada <- filter(dados, `Intensidade Dor` == "Nada")
dados_Nadaqueincomode <- filter(dados, `Intensidade Dor` == "Nada que chegue a incomodar")
dados_Problematica <- filter(dados, `Intensidade Dor` == "Problemática, mas não forte")
dados_Forte <- filter(dados, `Intensidade Dor` == "Forte")
```

```{r fig.cap = legenda_bar_mescomecou,fig.width = 8,fig.asp=1.618/5}
bar_mescomecou_nada <- ggplot(data = dados_Nada)   + facet_wrap(~`Intensidade Dor` , nrow = 2) +  geom_bar(mapping = aes(x = `Mês da gravidez onde a dor começou`,y = (..count..)/sum(..count..))) + theme_minimal() + ylab("Prop. de casos") + ylim(c(0,1)) + xlab("Início da dor (Mês da gravidez)")
bar_mescomecou_Nadaqueincomode <- ggplot(data = dados_Nadaqueincomode) + facet_wrap(~`Intensidade Dor` , nrow = 2) +  geom_bar(mapping = aes(x = `Mês da gravidez onde a dor começou`,y = (..count..)/sum(..count..))) + theme_minimal() + ylab("Prop. de casos") + ylim(c(0,.6)) + xlab("Início da dor (Mês da gravidez)")
bar_mescomecou_Problematica <- ggplot(data = dados_Problematica)  + facet_wrap(~`Intensidade Dor` , nrow = 2) + geom_bar(mapping = aes(x = `Mês da gravidez onde a dor começou`,y = (..count..)/sum(..count..))) + theme_minimal() + ylab("Prop. de casos") + ylim(c(0,.6)) + xlab("Início da dor (Mês da gravidez)")
bar_mescomecou_Forte <- ggplot(data = dados_Forte)  + facet_wrap(~`Intensidade Dor` , nrow = 2) +  geom_bar(mapping = aes(x = `Mês da gravidez onde a dor começou`,y = (..count..)/sum(..count..))) + theme_minimal() + ylab("Prop. de casos") + ylim(c(0,.6)) + xlab("Início da dor (Mês da gravidez)")

#bar_mescomecou_nada são todos os mesmos valores, por isso não entro esse grafico no trabalho.

bar_mescomecou <- grid.arrange(bar_mescomecou_Nadaqueincomode,bar_mescomecou_Problematica,bar_mescomecou_Forte, ncol = 3)

bar_mescomecou  

legenda_bar_mescomecou <- "Gráfico de barras para mês da gravidez que começou a dor nas costas por grupo de intensidade de dor nas costas durante a gravidez. O eixo y representa a proporção de casos de dor que se iniciaram nos grupos (mêses de gravidez) do eixo x em relação ao total de casos de cada grupo de intensidade de dor. Note que os gráficos têm comportamento bem diferente. Para o grupo de dor 'Nada que chegue a incomodar', predominantemente a dor se inicia  no mês inicial (0) e após esse mês a proporção de casos têm um crescimento conforme se avança nos meses da gravidez. Para o grupo de intensidade de do 'Problemática, mas não forte' se observa uma mesma proporção de casos nos três primeiros meses, depois um crescimento até o pico no sexto mês de gravidez, quando a proporção começa a decrescer. Para o grupo de intensidade de dor 'Forte' se observa uma maior distribuição dos casos pelos meses de gravidez, apresentando maior proporção no mês 3 e menores proporções nos meses 4,5 e 9. OBS: o gráfico para o grupo de intensidade de dor 'Nada' não foi apresentado já que não apresentou dor."
```

```{r fig.cap = legenda_bar_nfilhos,fig.width = 6,fig.asp=1.618/3}


bar_nfilhos_nada <- ggplot(data = dados_Nada)  + facet_wrap(~`Intensidade Dor` , nrow = 2) + geom_bar(mapping = aes(x = `Número de filhos anteriores à atual gravidez`,y = (..count..)/sum(..count..))) + theme_minimal() + ylab("Prop. de casos") + ylim(c(0,.75)) + xlab("Nº de filhos anteriores")
bar_nfilhos_Nadaqueincomode <- ggplot(data = dados_Nadaqueincomode)  + facet_wrap(~`Intensidade Dor` , nrow = 2) + geom_bar(mapping = aes(x = `Número de filhos anteriores à atual gravidez`,y = (..count..)/sum(..count..))) + theme_minimal() + ylab("Prop. de casos") + ylim(c(0,.75)) + xlab("Nº de filhos anteriores")
bar_nfilhos_Problematica <- ggplot(data = dados_Problematica)  + facet_wrap(~`Intensidade Dor` , nrow = 2) + geom_bar(mapping = aes(x = `Número de filhos anteriores à atual gravidez`,y = (..count..)/sum(..count..))) + theme_minimal() + ylab("Prop. de casos") + ylim(c(0,.75)) + xlab("Nº de filhos anteriores")
bar_nfilhos_Forte <- ggplot(data = dados_Forte)  + facet_wrap(~`Intensidade Dor` , nrow = 2) + geom_bar(mapping = aes(x = `Número de filhos anteriores à atual gravidez`,y = (..count..)/sum(..count..))) + theme_minimal() + ylab("Prop. de casos") + ylim(c(0,.75)) + xlab("Nº de filhos anteriores")


bar_nfilhos <- grid.arrange(bar_nfilhos_nada,bar_nfilhos_Nadaqueincomode,bar_nfilhos_Problematica,bar_nfilhos_Forte, ncol = 2)

legenda_bar_nfilhos <- "Gráfico de barras para mês da gravidez que começou a dor nas costas por grupo de intensidade de dor nas costas durante a gravidez. O eixo y representa a proporção de pacientes dos grupos (número de filhos anteriores) do eixo x em relação ao total de casos de cada grupo de intensidade de dor. Observe que para todos os grupos de intensidade de dor a maior parte dos casos ocorre nos grupos referentes aos valores 0 e 1 e nos demais números de filhos temos uma menor concentração de casos, com excessão do grupo de intensidade 'Nada' que apresenta uma grande proporção no valor 4. OBS: os valores aos quais não observou-se nenhuma ocorrência não estão representados, de maneira a privilegiar a vizualização das proporções"

```

```{r fig.cap = legenda_bar_doranterior,fig.width = 6,fig.asp=1.618/3}

bar_doranterior_nada <- ggplot(data = dados_Nada)  + facet_wrap(~`Intensidade Dor` , nrow = 2) + geom_bar(mapping = aes(x = `A paciente teve dor nas costas em gravidezes anteriores?`,y = (..count..)/sum(..count..))) + theme_minimal() + ylab("Prop. de casos") + ylim(c(0,.8)) + xlab("Dor nas costas em gravidezes anteriores?")
bar_doranterior_Nadaqueincomode <- ggplot(data = dados_Nadaqueincomode)  + facet_wrap(~`Intensidade Dor` , nrow = 2) + geom_bar(mapping = aes(x = `A paciente teve dor nas costas em gravidezes anteriores?`,y = (..count..)/sum(..count..))) + theme_minimal() + ylab("Prop. de casos") + ylim(c(0,.8)) + xlab("Dor nas costas em gravidezes anteriores?")
bar_doranterior_Problematica <- ggplot(data = dados_Problematica)  + facet_wrap(~`Intensidade Dor` , nrow = 2) + geom_bar(mapping = aes(x = `A paciente teve dor nas costas em gravidezes anteriores?`,y = (..count..)/sum(..count..))) + theme_minimal() + ylab("Prop. de casos") + ylim(c(0,.8)) + xlab("Dor nas costas em gravidezes anteriores?")
bar_doranterior_Forte <- ggplot(data = dados_Forte)  + facet_wrap(~`Intensidade Dor` , nrow = 2) + geom_bar(mapping = aes(x = `A paciente teve dor nas costas em gravidezes anteriores?`,y = (..count..)/sum(..count..))) + theme_minimal() + ylab("Prop. de casos") + ylim(c(0,.8)) + xlab("Dor nas costas em gravidezes anteriores?")

bar_doranterior <-grid.arrange(bar_doranterior_nada,bar_doranterior_Nadaqueincomode,bar_doranterior_Problematica,bar_doranterior_Forte, ncol = 2)
bar_doranterior
legenda_bar_doranterior <- "Gráfico de barras para dor em gravidezes anteriores por grupo de intensidade de dor nas costas durante a gravidez. O eixo y representa a proporção de pacientes dos grupos (dor em gravidezes anteriores) do eixo x em relação ao total de casos de cada grupo de intensidade de dor. Note que o comportamento dos gráficos de barra são bem diferentes entre os grupos de intensidade de dor. Para o grupo 'Nada' observamos que não existe nenhum caso de dor em gravidez anterior, para o grupo 'Nada que chegue a incomodar' a maioria das observações são observadas na classificação 'Não aplicável' e nos demois grupos existe uma relação decrescente se levarmos em consideração a sequência de classificações 'Não','Sim, suave' e 'Sim, forte', no grupo 'Problemática, mas não forte' se observa grande proporção de casos em 'não aplicável' e um comportamento similar ao grupo anterior quanto às demais classificações. Já o grupo 'Forte' apresenta proporções bem próximas para as classificações 'Não aplivável', 'Não' e 'Sim, suave' e menor proporção para a classificação 'Sim, forte'."

```


##3.3.Mapas de árvore

```{r preparacao dos dados para calcular proporcoes}
#novos rotulos para não ficar duas linhas com o mesmo nome
rotulos2 <- c("ID","Intensidade Dor","Mês da gravidez onde a dor começou","Idade da paciente","Altura da paciente (m)","Peso da paciente no início da gravidez (kg)","Peso no final da gravidez","Peso do bebê (kg)","Número de filhos anteriores à atual gravidez","A paciente teve dor nas costas em gravidezes anteriores?","Comprimidos e aspirina(a)","Bolsa de agua quente(a)","Banho quente(a)","Almofada atrás da cadeira(a)","Ficar em pé(a)","Estar sentada(a)","Estar deitada(a)","Caminhar(a)","Fadiga","Inclinar-se","Erguer-se","Arrumar camas","Lavar","Passar roupa","Uma ação intestinal","Relações sexuais","Tosser","Espirrar","Virar-se na cama","Ficar em pé","Estar sentada","Estar deitada","Caminhar")
colnames(dados_base) <- rotulos2
#dados com números (dados_nada estão como fatores)
dados_Nada2 <- filter(dados_base, `Intensidade Dor` == 0)
dados_Nadaqueincomode2 <- filter(dados_base, `Intensidade Dor` == 1)
dados_Problematica2 <- filter(dados_base, `Intensidade Dor` == 2)
dados_Forte2 <- filter(dados_base, `Intensidade Dor` == 3)
```

```{r preparacao dos dados alivia para calcular proporcoes}
proporcao <- function(x){  return(c(soma = sum(x),n = length(x),p = sum(x)/length(x)))}

tb_Forte_alivia <- apply(dados_Forte2[,11:18],2, proporcao)
ordem_Forte_alivia <- order(tb_Forte_alivia[3,]) #ordem crescente dos p
tb_Forte_ordem_alivia <- tb_Forte_alivia[,ordem_Forte_alivia]

tb_Problematica_alivia <- apply(dados_Problematica2[,11:18],2, proporcao)
tb_Problematica_alivia <- tb_Problematica_alivia[,ordem_Forte_alivia]

tb_Nadaqueincomode_alivia <- apply(dados_Nadaqueincomode2[,11:18],2, proporcao)
tb_Nadaqueincomode_alivia <- tb_Nadaqueincomode_alivia[,ordem_Forte_alivia]

tabela_proporcao_alivia <- cbind(tb_Nadaqueincomode_alivia[3,],tb_Problematica_alivia[3,], tb_Forte_alivia[3,])
colnames(tabela_proporcao_alivia) <- c("Nada que incomode","Problemática","Forte")
#só para tirar o (a) dos nomes, agora não terá problema com repetições
rownames(tabela_proporcao_alivia) <- c("Ficar em pé","Caminhar","Bolsa de agua quente","Estar sentada","Banho quente","Estar deitada","Comprimidos e aspirina","Almofada atrás da cadeira")
```

```{r preparacao dos dados agrava para calcular propocoes}
tb_Forte_agrava <- apply(dados_Forte2[,19:33],2, proporcao)
ordem_Forte_agrava <- order(tb_Forte_agrava[3,]) #ordem crescente dos p
tb_Forte_ordem_agrava <- tb_Forte_agrava[,ordem_Forte_agrava]

tb_Problematica_agrava <- apply(dados_Problematica2[,19:33],2, proporcao)
tb_Problematica_agrava <- tb_Problematica_agrava[,ordem_Forte_agrava]

tb_Nadaqueincomode_agrava <- apply(dados_Nadaqueincomode2[,19:33],2, proporcao)
tb_Nadaqueincomode_agrava <- tb_Nadaqueincomode_agrava[,ordem_Forte_agrava]

tabela_proporcao_agrava <- cbind(tb_Nadaqueincomode_agrava[3,],tb_Problematica_agrava[3,], tb_Forte_agrava[3,])
colnames(tabela_proporcao_agrava) <- c("Nada que incomode","Problemática","Forte")
```

```{r preparacao dos dados agrava para treemaps}
agrava <- melt(tabela_proporcao_agrava)
agrava <- cbind(agrava)
colnames(agrava) <- c("Pergunta","Intensidade dor","Proporção de sim")
```

```{r preparacao dos dados alivia para treemaps}
alivia <- melt(tabela_proporcao_alivia)
colnames(alivia) <- c("Pergunta","Intensidade dor","Proporção de sim")
```

```{r preparacao dos dados para calcular proporcoes totais}
proptotal_agrava <- apply(dados_base[,19:33],2,function(x){return(sum(x)/length(x))})
proptotal_agrava <- proptotal_agrava[ordem_Forte_agrava]
p <-  as.character(agrava[1:length(proptotal_agrava),1])
proptotal_agrava <- data.frame(cbind(proptotal_agrava,1))
proptotal_agrava[,2] <- p
colnames(proptotal_agrava) <- c("Proporção Total de sim","Pergunta")


proptotal_alivia <-  apply(dados_base[,11:18],2,function(x){return(sum(x)/length(x))})

proptotal_alivia <- proptotal_alivia[ordem_Forte_alivia]
p <- as.character(alivia[1:length(proptotal_alivia),1])
proptotal_alivia <- data.frame(cbind(as.double(proptotal_alivia),1))
proptotal_alivia[,2] <- p
colnames(proptotal_alivia) <- c("Proporção Total de sim","Pergunta")
```

```{r fig.cap = legenda_treemap_proptotal_alivia, fig.width = 10,fig.asp=1.618/5}
#mapa de arvore

library(treemap)
#mapping = c(min(values), mean(range(values)), max(values))
treemap_proptotal_alivia <- treemap(proptotal_alivia, #Your data frame object
        index="Pergunta",  #A list of your categorical variables
        vSize = "Proporção Total de sim",  #This is your quantitative variable
        #type= "values",
        vColor = "Proporção Total de sim",
        #value = 1,
        type= "value",#Type sets the organization and color scheme of your treemap
        range = c(0,.35),
        palette = gray.colors(8,start = 0.05,end = 1,gamma = .5),  #Select your color palette from the RColorBrewer presets or make your own. 
        #palette = "#FFFFFF", # para ficar branco usei o comando "gray(1)"
        #type = "value",
        #mapping = c(, 0, 0),
        #range = c(0,1),
        n = 6,
        title="Mapa de Arvore para fatores que aliviam a dor em geral", #Customize your title
        fontsize.title = 12 #Change the font size of the title
        )
#treemap_proptotal_alivia
legenda_treemap_proptotal_alivia <- "Mapa de árvore para os fatores que possivelmente aliviam a dor nas costas durante a gravidez das pacientes. As áreas dos retângulos são proporcionais às proporções totais de pacientes que responderam que tal fator alivia a dor nas costas, ou seja, quanto maior for o retângulo respectivo ao fator (escrito dentro do retângulo), maior será a proporção de pacientes que diz que o fator alivia a dor nas costas comparado com os demais fatores. A escala de cor têm o objetivo de ajudar a ter uma dimensão em termos absolutos da proporção mensionada para os fatores. Note que os fatores 'Almofada atrás da cadeira', 'Estar deitada' e 'Comprimidos e aspirina' ocupam a maior parte da área do gráfico, ou seja, a soma das proporções destes é maior do que a soma dos demais fatores que avaliados quanto a redução da dor nas costas."
```

```{r fig.cap = legenda_treemap_proptotal_agrava, fig.width = 10,fig.asp=1.618/5}
treemap_proptotal_agrava <- treemap(proptotal_agrava, #Your data frame object
        index="Pergunta",  #A list of your categorical variables
        vSize = "Proporção Total de sim",  #This is your quantitative variable
        #type= "values",
        vColor = "Proporção Total de sim",
        #value = 1,
        type= "value",#Type sets the organization and color scheme of your treemap
        range = c(0,.35),
        palette = gray.colors(8,start = 0.05,end = 1,gamma = .5),  #Select your color palette from the RColorBrewer presets or make your own. 
        #palette = "#FFFFFF", # para ficar branco usei o comando "gray(1)"
        #type = "value",
        #mapping = c(, 0, 0),
        #range = c(0,1),
        n = 6,
        title="Mapa de Arvore para fatores que agravam a dor em Geral", #Customize your title
        fontsize.title = 12 #Change the font size of the title
        )
#treemap_proptotal_agrava
legenda_treemap_proptotal_agrava <- "Mapa de árvore para os fatores que possivelmente agravam a dor nas costas durante a gravidez das pacientes. As áreas dos retângulos são proporcionais às proporções totais de pacientes que responderam que tal fator agrava a dor nas costas, ou seja, quanto maior for o retângulo respectivo ao fator (escrito dentro do retângulo), maior será a proporção de pacientes que diz que o fator agrava a dor nas costas comparado com os demais fatores. A escala de cor têm o objetivo de ajudar a ter uma dimensão em termos absolutos da proporção mensionada para os fatores. Note que os fatores com maior destaque são 'Ficar em pé' e 'Fadiga'. Por terem proporções muito pequenas, alguns fatores não estão bem visiveis no gráfico, estes fatores, ordenamos suas proporções decrescentemente, são 'Tosser','Espirrar', 'Relações sexuais' e 'Uma ação intestinal'"
```

```{r fig.cap = legenda_treemap_alivia_nadaqueincomode, fig.width = 10,fig.asp=1.618/5}
#mapa de arvore para cada nível de dor para alivia a dor nível nada que incomode
alivia_nadaqueincomode <- filter(alivia, `Intensidade dor` == "Nada que incomode")


treemap_alivia_nadaqueincomode <- treemap(alivia_nadaqueincomode, #Your data frame object
        index=c("Pergunta"),  #A list of your categorical variables
        vSize = "Proporção de sim",  #This is your quantitative variable
        #type= "values",
        vColor = "Proporção de sim",
        #value = 1,
        type = "value",
        #type= "categorical",#Type sets the organization and color scheme of your treemap
        range = c(0,.25),
        palette = gray.colors(8,start = 0.1,end = 1,gamma = 3),  #Select your color palette from the RColorBrewer presets or make your own. 
        #palette = "#FFFFFF", # para ficar branco usei o comando "gray(1)"
        #type = "value",
        #mapping = c(, 0, 0),
        #range = c(0,1),
        n = 8,
        title="Mapa de Arvore para fatores que aliviam a dor para nível de dor 'Nada que incomode'", #Customize your title
        fontsize.title = 12 #Change the font size of the title
        )
#treemap_alivia_nadaqueincomode
legenda_treemap_alivia_nadaqueincomode <- "Mapa de árvore para os fatores que possivelmente agravam a dor nas costas durante a gravidez das pacientes para pacientes do grupo de intensidade de dro 'Nada que incomode'. As áreas dos retângulos são proporcionais às proporções totais de pacientes que responderam que tal fator alivia a dor nas costas, ou seja, quanto maior for o retângulo respectivo ao fator (escrito dentro do retângulo), maior será a proporção de pacientes que diz que o fator alivia a dor nas costas comparado com os demais fatores. A escala de cor têm o objetivo de ajudar a ter uma dimensão em termos absolutos da proporção mensionada para os fatores. Note que os fatores 'Almofada atrás da cadeira', 'Estar deitada' e 'Comprimidos e aspirina' ocupam a maior parte da área do gráfico, ou seja, a soma das proporções destes é maior do que a soma dos demais fatores que avaliados quanto a redução da dor nas costas para pacientes do grupo de intensidade de dor 'Nada que incomode'."
```

```{r fig.cap = legenda_treemap_alivia_problematica, fig.width = 10,fig.asp=1.618/5}
#mapa de arvore para cada nível de dor para alivia a dor nível 'Problemática'
alivia_problematica <- filter(alivia, `Intensidade dor` == "Problemática")


treemap_alivia_problematica <- treemap(alivia_problematica, #Your data frame object
        index=c("Pergunta"),  #A list of your categorical variables
        vSize = "Proporção de sim",  #This is your quantitative variable
        #type= "values",
        vColor = "Proporção de sim",
        #value = 1,
        type = "value",
        #type= "categorical",#Type sets the organization and color scheme of your treemap
        range = c(0,.55),
        palette = gray.colors(8,start = 0.1,end = 1,gamma = 3),  #Select your color palette from the RColorBrewer presets or make your own. 
        #palette = "#FFFFFF", # para ficar branco usei o comando "gray(1)"
        #type = "value",
        #mapping = c(, 0, 0),
        #range = c(0,1),
        n = 8,
        title="Mapa de Arvore para fatores que aliviam a dor para nível de dor 'Problemática'", #Customize your title
        fontsize.title = 12 #Change the font size of the title
        )
#treemap_alivia_problematica
legenda_treemap_alivia_problematica <- "Mapa de árvore para os fatores que possivelmente agravam a dor nas costas durante a gravidez das pacientes para pacientes do grupo de intensidade de dro 'Nada que incomode'. As áreas dos retângulos são proporcionais às proporções totais de pacientes que responderam que tal fator alivia a dor nas costas, ou seja, quanto maior for o retângulo respectivo ao fator (escrito dentro do retângulo), maior será a proporção de pacientes que diz que o fator alivia a dor nas costas comparado com os demais fatores. A escala de cor têm o objetivo de ajudar a ter uma dimensão em termos absolutos da proporção mensionada para os fatores. Note que os fatores 'Almofada atrás da cadeira', 'Estar deitada' e 'Estar deitada' ocupam a maior parte da área do gráfico, ou seja, a soma das proporções destes é maior do que a soma dos demais fatores que avaliados quanto a redução da dor nas costas para pacientes do grupo de intensidade de dor 'Problemática'."
```

```{r fig.cap = legenda_treemap_alivia_forte, fig.width = 10,fig.asp=1.618/5}
#mapa de arvore para cada nível de dor para alivia a dor nível 'Forte'
alivia_forte <- filter(alivia, `Intensidade dor` == "Forte")


treemap_alivia_forte <- treemap(alivia_forte, #Your data frame object
        index=c("Pergunta"),  #A list of your categorical variables
        vSize = "Proporção de sim",  #This is your quantitative variable
        #type= "values",
        vColor = "Proporção de sim",
        #value = 1,
        type = "value",
        #type= "categorical",#Type sets the organization and color scheme of your treemap
        range = c(0,.45),
        palette = gray.colors(8,start = 0.00,end = 1,gamma = 1),  #Select your color palette from the RColorBrewer presets or make your own. 
        #palette = "#FFFFFF", # para ficar branco usei o comando "gray(1)"
        #type = "value",
        #mapping = c(, 0, 0),
        #range = c(0,1),
        n = 8,
        title="Mapa de Arvore para fatores que aliviam a dor para nível de dor 'Forte'", #Customize your title
        fontsize.title = 12 #Change the font size of the title
        )
#treemap_alivia_forte
legenda_treemap_alivia_forte <- "Mapa de árvore para os fatores que possivelmente agravam a dor nas costas durante a gravidez das pacientes para pacientes do grupo de intensidade de dor 'Nada que incomode'. As áreas dos retângulos são proporcionais às proporções totais de pacientes que responderam que tal fator alivia a dor nas costas, ou seja, quanto maior for o retângulo respectivo ao fator (escrito dentro do retângulo), maior será a proporção de pacientes que diz que o fator alivia a dor nas costas comparado com os demais fatores. A escala de cor têm o objetivo de ajudar a ter uma dimensão em termos absolutos da proporção mensionada para os fatores. Note que os fatores 'Estar sentada', 'Ficar em pé' e 'Comprimidos e aspirina' ocupam a maior parte da área do gráfico, ou seja, a soma das proporções destes é maior do que a soma dos demais fatores que avaliados quanto a redução da dor nas costas para pacientes do grupo de intensidade de dor 'Forte'."
```

```{r fig.cap = legenda_treemap_agrava_nadaqueincomode, fig.width = 10,fig.asp=1.618/5}

#mapa de arvore para cada nível de dor para agrava a dor nível nada que incomode

agrava_nadaqueincomode <- filter(agrava, `Intensidade dor` == "Nada que incomode")


treemap_agrava_nadaqueincomode <- treemap(agrava_nadaqueincomode, #Your data frame object
        index=c("Pergunta"),  #A list of your categorical variables
        vSize = "Proporção de sim",  #This is your quantitative variable
        #type= "values",
        vColor = "Proporção de sim",
        #value = 1,
        type = "value",
        #type= "categorical",#Type sets the organization and color scheme of your treemap
        range = c(0,.15),
        palette = gray.colors(8,start = 0.1,end = 1,gamma = 3),  #Select your color palette from the RColorBrewer presets or make your own. 
        #palette = "#FFFFFF", # para ficar branco usei o comando "gray(1)"
        #type = "value",
        #mapping = c(, 0, 0),
        #range = c(0,1),
        n = 13,
        title="Mapa de Arvore para fatores que agravam a dor para nível de dor 'Nada que incomode'", #Customize your title
        fontsize.title = 12 #Change the font size of the title
        )

legenda_treemap_agrava_nadaqueincomode <- "Mapa de árvore para os fatores que possivelmente agravam a dor nas costas durante a gravidez das pacientes para pacientes do grupo de intensidade de dor 'Nada que incomode'. As áreas dos retângulos são proporcionais às proporções totais de pacientes que responderam que tal fator alivia a dor nas costas, ou seja, quanto maior for o retângulo respectivo ao fator (escrito dentro do retângulo), maior será a proporção de pacientes que diz que o fator alivia a dor nas costas comparado com os demais fatores. A escala de cor têm o objetivo de ajudar a ter uma dimensão em termos absolutos da proporção mensionada para os fatores. Note que os fatores 'Estar sentada', 'Fadiga', 'Ficar em pé', ' Inclinar-se', 'arrumar camas' e 'Passar roupa' ocupam a maior parte da área do gráfico, ou seja, a soma das proporções destes é maior do que a soma dos demais fatores avaliados quanto a redução da dor nas costas para pacientes do grupo de intensidade de dor 'Nada que incomode'. Por terem proporções muito pequenas, alguns fatores não estão bem visiveis no gráfico, estes fatores são 'Espirrar' e 'Relações sexuais' e têm mesmo valor de proporção."
```

```{r fig.cap = legenda_treemap_agrava_problematica, fig.width = 10,fig.asp=1.618/5}
#mapa de arvore para cada nível de dor para agrava a dor nível 'Problemática'
agrava_problematica <- filter(agrava, `Intensidade dor` == "Problemática")


treemap(agrava_problematica, #Your data frame object
        index=c("Pergunta"),  #A list of your categorical variables
        vSize = "Proporção de sim",  #This is your quantitative variable
        #type= "values",
        vColor = "Proporção de sim",
        #value = 1,
        type = "value",
        #type= "categorical",#Type sets the organization and color scheme of your treemap
        range = c(0,.45),
        palette = gray.colors(8,start = 0.1,end = 1,gamma = 3),  #Select your color palette from the RColorBrewer presets or make your own. 
        #palette = "#FFFFFF", # para ficar branco usei o comando "gray(1)"
        #type = "value",
        #mapping = c(, 0, 0),
        #range = c(0,1),
        n = 13,
        title="Mapa de Arvore para fatores que agravam a dor para nível de dor 'Problemática'", #Customize your title
        fontsize.title = 12 #Change the font size of the title
        )
legenda_treemap_agrava_problematica <- "Mapa de árvore para os fatores que possivelmente agravam a dor nas costas durante a gravidez das pacientes para pacientes do grupo de intensidade de dor 'Problemática'. As áreas dos retângulos são proporcionais às proporções totais de pacientes que responderam que tal fator agrava a dor nas costas, ou seja, quanto maior for o retângulo respectivo ao fator (escrito dentro do retângulo), maior será a proporção de pacientes que diz que o fator agrava a dor nas costas comparado com os demais fatores. A escala de cor têm o objetivo de ajudar a ter uma dimensão em termos absolutos da proporção mensionada para os fatores. Note que os fatores 'Ficar em pé', 'Arrumar camas', 'Passar roupa' ocupam cerca de metade da área do gráfico, ou seja, a soma das proporções destes é aproximadamente o mesmo valor que a soma dos demais fatores avaliados quanto a redução da dor nas costas para pacientes do grupo de intensidade de dor 'Problemática'. Por ter proporção muito pequena e seu nome nome é grande, o fator 'Uma ação intestinal' não é bem visivel no gráfico, porém tem a mesma proporção do fator 'Espirrar'."
```

```{r fig.cap = legenda_treemap_agrava_forte, fig.width = 10,fig.asp=1.618/5}
#mapa de arvore para cada nível de dor para agrava a dor nível 'Forte'
agrava_forte <- filter(agrava, `Intensidade dor` == "Forte")


treemap(agrava_forte, #Your data frame object
        index=c("Pergunta"),  #A list of your categorical variables
        vSize = "Proporção de sim",  #This is your quantitative variable
        #type= "values",
        vColor = "Proporção de sim",
        #value = 1,
        type = "value",
        #type= "categorical",#Type sets the organization and color scheme of your treemap
        range = c(0,.45),
        palette = gray.colors(8,start = 0.1,end = 1,gamma = 3),  #Select your color palette from the RColorBrewer presets or make your own. 
        #palette = "#FFFFFF", # para ficar branco usei o comando "gray(1)"
        #type = "value",
        #mapping = c(, 0, 0),
        #range = c(0,1),
        n = 13,
        title="Mapa de Arvore para fatores que agravam a dor para nível de dor 'Forte'", #Customize your title
        fontsize.title = 12 #Change the font size of the title
        )
legenda_treemap_agrava_forte <- "Mapa de árvore para os fatores que possivelmente agravam a dor nas costas durante a gravidez das pacientes para pacientes do grupo de intensidade de dor 'Forte'. As áreas dos retângulos são proporcionais às proporções totais de pacientes que responderam que tal fator agrava a dor nas costas, ou seja, quanto maior for o retângulo respectivo ao fator (escrito dentro do retângulo), maior será a proporção de pacientes que diz que o fator agrava a dor nas costas comparado com os demais fatores. A escala de cor têm o objetivo de ajudar a ter uma dimensão em termos absolutos da proporção mensionada para os fatores. Note que os fatores 'Estar sentada', 'Ficar em pé', 'Uma ação intestinal','caminhar','Espirrar' e 'Estar deitada' ocupam a maior parte da área do gráfico, ou seja, a soma das proporções destes é maior do que a soma dos demais fatores que avaliados quanto a redução da dor nas costas para pacientes do grupo de intensidade de dor 'Forte'."
```
