---
title: ""
geometry: textwidth=18cm,textheight=24cm
lang: pt-br
header-includes:
- \usepackage{setspace}
- \usepackage{indentfirst}
- \usepackage[utf8]{inputenc}
- \usepackage{mathptmx}
- \usepackage{enumerate}
- \usepackage{url} 
- \usepackage{lipsum}
- \usepackage{multicol}
- \usepackage{float}
- \usepackage{subcaption}
output:
  pdf_document:
  html_document: default
  fig_caption: yes
  mainfont: Times New Roman
fontsize: 10bp
---

\begin{titlepage}
\begin{center}
\thispagestyle{empty}
\begin{figure}[!htb]
\begin{center}
\begin{minipage}[b]{0.5\linewidth}
\begin{center}
\end{center}
\end{minipage}
\begin{minipage}[b]{0.7\linewidth}
\begin{center}
\vspace*{1cm}
 {\large \bf Universidade Estadual de Campinas\\[5pt]
Instituto de Matemática, Estatística e Computação Cientifica\\[3pt]
Departamento de Estatística}
\end{center}
\end{minipage}
\end{center}
\end{figure}
\vspace*{\stretch{1}}
\begin{center}
\vspace*{5cm}
{\huge \bf Dor nas costas durante a gravidez \\[7pt]
Relatório Técnico\\[5pt]
}
\end{center}
\vspace*{\stretch{1}}
\begin{center}
\vspace*{4cm}
{\Large \bf Guilherme Pazian  RA:160323\break
}\\[3pt]
{\large \bf Professor: Mauricio Zevallos \\[5pt]
ME610}\\[5pt]
\end{center}
\vspace*{\stretch{1}}
\centerline{\bf Campinas-SP, 30 de Junho de 2017}
\vspace*{\stretch{1}}
\end{center}
\end{titlepage}

\doublespacing
\newpage


```{r chunck options, echo=FALSE}
#definindo opções padrões dos chunks
knitr::opts_chunk$set(fig.width=7, fig.align='center',fig.path='Figs/', fig.pos="H", fig.asp=0.6, echo=FALSE, warning=FALSE, message=FALSE)
```

```{r global otions,echo=FALSE}
#mudando o separador decimal para resultados "printados"
options(OutDec= ",")

#carregando funções
source("funcoes.R")

#pacotes
library(ggplot2)
```




```{r reading the data,cache=TRUE}
dados_base <- read.table(file = "dados-trab.txt")
rotulos <- c("ID","Intensidade Dor","Mês da gravidez onde a dor começou","Idade da paciente","Altura da paciente (m)","Peso da paciente no início da gravidez (kg)","Peso no final da gravidez","Peso do bebê (kg)","Número de filhos anteriores à atual gravidez","A paciente teve dor nas costas em gravidezes anteriores?","Comprimidos e aspirina alivia a dor?","Bolsa de agua quente alivia a dor?","Banho quente alivia a dor?","Almofada atrás da cadeira alivia a dor?","Ficar em pé alivia a dor?","Estar sentada alivia a dor?","Estar deitada alivia a dor?","Caminhar alivia a dor?","Fadiga agrava a dor?","Inclinar-se agrava a dor?","Erguer-se agrava a dor?","Arrumar camas agrava a dor?","Lavar agrava a dor?","Passar roupa agrava a dor?","Uma ação intestinal agrava a dor?","Relações sexuais agrava a dor?","Tosser agrava a dor?","Espirrar agrava a dor?","Virar-se na cama agrava a dor?","Ficar em pé agrava a dor?","Estar sentada agrava a dor?","Estar deitada agrava a dor?","Caminhar agrava a dor?")
colnames(dados_base) <- rotulos

```

#Validação do banco de dados

Após uma analise prévia do banco de dados, observou-se uma inconsistência na base de dados, já que foi observada uma valor "0" para a variável relacionada à dor nas costas em gravidezes anteriores e este valor não têm nenhuma definição na descrição desta variável. 


```{r insconsistencias}
library(dplyr)
#tirando inconsistências
dados_base <- filter(dados_base, `A paciente teve dor nas costas em gravidezes anteriores?` != 0)
```


```{r inteiro em fator}
#fator

dados <- dados_base
dados$`Intensidade Dor`<- ordered(dados$`Intensidade Dor`, levels = c(0,1,2,3),labels = c("Nada","Nada que chegue a incomodar",
"Problemática, mas não forte", "Forte"))

dados$`Mês da gravidez onde a dor começou` <- ordered(dados$`Mês da gravidez onde a dor começou`)

dados$`Número de filhos anteriores à atual gravidez` <- ordered(dados$`Número de filhos anteriores à atual gravidez`)

dados$`A paciente teve dor nas costas em gravidezes anteriores?` <- ordered(dados$`A paciente teve dor nas costas em gravidezes anteriores?`,levels = c(1,2,3,4), labels = c("Não aplicável","Não","Sim, suave","Sim, forte"))

dados[,11:33] <- apply(dados[,11:33],2,function(x){factor(x,levels = c(0,1),labels = c("Não","Sim"))})

```

#Análise Descritiva







```{r box_idade, fig.cap = legenda_box_idade}
box_idade <- ggplot(data = dados,mapping = aes(x = `Intensidade Dor`, y=  `Idade da paciente`)) + geom_boxplot()  + theme_light() + theme(axis.text.x = element_text(angle = 15,hjust = 1,size = 10))
box_idade
legenda_box_idade = "Boxplot para idade da paciente por intensidade de dor nas costas durante a gravidez. Note que os grupos 'Nada que chegue a incomodar' e 'Problemática, mas não forte' parecem ser os grupos mais similares, o grupo 'Nada' e 'Forte' parecem ser distintos tanto entre si quanto entre os demais grupos"
```



```{r box_altura, fig.cap = legenda_box_altura}
box_altura <- ggplot(data = dados,mapping = aes(x = `Intensidade Dor`, y=  `Altura da paciente (m)`)) + geom_boxplot() + theme_light() + theme(axis.text.x = element_text(angle = 15,hjust = 1,size = 10))
box_altura
legenda_box_altura = "Boxplot para altura da paciente por intensidade de dor nas costas durante a gravidez. Note que os grupos 'Nada que chegue a incomodar' e 'Problemática, mas não forte' parecem ser os grupos mais similares, o grupo 'Nada' e 'Forte' parecem ser distintos tanto entre si quanto entre os demais grupos"
```



```{r fig.cap = legenda_PesoAntes}
box_PesoAntes <- ggplot(data = dados,mapping = aes(x = `Intensidade Dor`, y=  `Peso da paciente no início da gravidez (kg)`)) + geom_boxplot() + theme_light() + theme(axis.text.x = element_text(angle = 15,hjust = 1))
box_PesoAntes
legenda_PesoAntes <- "Boxplot para Peso da paciente antes da gravidez por intensidade de dor nas costas durante a gravidez. Note que os grupos 'Nada que chegue a incomodar' e 'Problemática, mas não forte' parecem ser os grupos mais similares, o grupo 'Nada' e 'Forte' parecem ser distintos tanto entre si quanto entre os demais grupos"
```

